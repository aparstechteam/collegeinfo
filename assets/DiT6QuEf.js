import{_ as W,b as X}from"./C-chuflN.js";import{r as N,o as f,c as B,b as d,w as P,m as b,x as F,F as q,D as T,B as I,E as H,H as A,Z as K,_ as Y,I as Z,J as x,K as E,M as U,P as S,y as j,z as O,q as M,n as J,j as Q,Y as ee,k as te,X as oe,l as ne,a as n,t as L,$ as ae,d as le,C as se}from"./DX-yIrQn.js";import{_ as ie}from"./BlwycjIN.js";import{_ as ue}from"./DVqv3c1K.js";import{_ as re,a as de}from"./CN4ZF7kh.js";const ce={wrapper:"flex items-center -space-x-px",base:"",rounded:"first:rounded-s-md last:rounded-e-md",default:{size:"sm",activeButton:{color:"primary"},inactiveButton:{color:"white"},firstButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-double-left-20-solid"},lastButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-double-right-20-solid"},prevButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-right-20-solid"}}},pe={__name:"ReviewModal",props:{review:Object},setup(e){const g=N(!1);return(_,s)=>{const a=T,p=I,i=ue,o=re;return f(),B(q,null,[d(p,{onClick:s[0]||(s[0]=m=>g.value=!0)},{default:P(()=>[d(a,{name:"lucide:info"})]),_:1}),d(o,{modelValue:b(g),"onUpdate:modelValue":s[1]||(s[1]=m=>F(g)?g.value=m:null)},{default:P(()=>[d(i,{review:e.review},null,8,["review"])]),_:1},8,["modelValue"])],64)}}},C=H(A.ui.strategy,A.ui.pagination,ce),fe=H(A.ui.strategy,A.ui.button,K),me=Z({components:{UButton:I},inheritAttrs:!1,props:{modelValue:{type:Number,required:!0},pageCount:{type:Number,default:10},total:{type:Number,required:!0},max:{type:Number,default:7,validate(e){return e>=5&&e<Number.MAX_VALUE}},disabled:{type:Boolean,default:!1},size:{type:String,default:()=>C.default.size,validator(e){return Object.keys(fe.size).includes(e)}},to:{type:Function,default:null},activeButton:{type:Object,default:()=>C.default.activeButton},inactiveButton:{type:Object,default:()=>C.default.inactiveButton},showFirst:{type:Boolean,default:!1},showLast:{type:Boolean,default:!1},firstButton:{type:Object,default:()=>C.default.firstButton},lastButton:{type:Object,default:()=>C.default.lastButton},prevButton:{type:Object,default:()=>C.default.prevButton},nextButton:{type:Object,default:()=>C.default.nextButton},divider:{type:String,default:"â€¦"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:g}){const{ui:_,attrs:s}=x("pagination",E(e,"ui"),C,E(e,"class")),a=U({get(){return e.modelValue},set(l){g("update:modelValue",l)}}),p=U(()=>Array.from({length:Math.ceil(e.total/e.pageCount)},(l,c)=>c+1)),i=U(()=>{const l=p.value.length,c=a.value,V=Math.max(e.max,5),v=Math.floor((Math.min(V,l)-5)/2),w=c-v,h=c+v,$=w-1>1,R=h+1<l,t=[];if(l<=V){for(let y=1;y<=l;y++)t.push(y);return t}if(t.push(1),$&&t.push(e.divider),!R){const y=c+v+2-l;for(let k=c-v-y;k<=c-v-1;k++)t.push(k)}for(let y=Math.max(2,w);y<=Math.min(l,h);y++)t.push(y);if(!$){const y=1-(c-v-2);for(let k=c+v+1;k<=c+v+y;k++)t.push(k)}return R&&t.push(e.divider),h<l&&t.push(l),t.length>=3&&t[1]===e.divider&&t[2]===3&&(t[1]=2),t.length>=3&&t[t.length-2]===e.divider&&t[t.length-1]===t.length&&(t[t.length-2]=t.length-1),t}),o=U(()=>a.value>1),m=U(()=>a.value<p.value.length);function z(){o.value&&(a.value=1)}function D(){m.value&&(a.value=p.value.length)}function G(l){typeof l!="string"&&(a.value=l)}function u(){o.value&&a.value--}function r(){m.value&&a.value++}return{ui:_,attrs:s,currentPage:a,pages:p,displayedPages:i,canGoLastOrNext:m,canGoFirstOrPrev:o,onClickPrev:u,onClickNext:r,onClickPage:G,onClickFirst:z,onClickLast:D}}});function ve(e,g,_,s,a,p){const i=I;return f(),B("div",O({class:e.ui.wrapper},e.attrs),[S(e.$slots,"first",{onClick:e.onClickFirst},()=>[e.firstButton&&e.showFirst?(f(),j(i,O({key:0,size:e.size,disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.firstButton||{},...e.firstButton},{ui:{rounded:""},"aria-label":"First",onClick:e.onClickFirst}),null,16,["size","disabled","class","onClick"])):M("",!0)]),S(e.$slots,"prev",{onClick:e.onClickPrev},()=>[e.prevButton?(f(),j(i,O({key:0,size:e.size,disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.prevButton||{},...e.prevButton},{ui:{rounded:""},"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["size","disabled","class","onClick"])):M("",!0)]),(f(!0),B(q,null,J(e.displayedPages,(o,m)=>{var z;return f(),j(i,O({key:`${o}-${m}`,to:typeof o=="number"?(z=e.to)==null?void 0:z.call(e,o):null,size:e.size,disabled:e.disabled,label:`${o}`,ref_for:!0},o===e.currentPage?{...e.ui.default.activeButton||{},...e.activeButton}:{...e.ui.default.inactiveButton||{},...e.inactiveButton},{class:[{"pointer-events-none":typeof o=="string","z-[1]":o===e.currentPage},e.ui.base,e.ui.rounded],ui:{rounded:""},onClick:()=>e.onClickPage(o)}),null,16,["to","size","disabled","label","class","onClick"])}),128)),S(e.$slots,"next",{onClick:e.onClickNext},()=>[e.nextButton?(f(),j(i,O({key:0,size:e.size,disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.nextButton||{},...e.nextButton},{ui:{rounded:""},"aria-label":"Next",onClick:e.onClickNext}),null,16,["size","disabled","class","onClick"])):M("",!0)]),S(e.$slots,"last",{onClick:e.onClickLast},()=>[e.lastButton&&e.showLast?(f(),j(i,O({key:0,size:e.size,disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.lastButton||{},...e.lastButton},{ui:{rounded:""},"aria-label":"Last",onClick:e.onClickLast}),null,16,["size","disabled","class","onClick"])):M("",!0)])],16)}const he=Y(me,[["render",ve]]),be={key:0,class:"max-w-6xl mx-auto py-10"},ye={class:"text-2xl font-semibold my-4"},ge={class:"flex justify-between mb-3"},_e={class:"flex gap-4 items-end"},Be={key:0,class:"relative overflow-x-auto shadow-md sm:rounded-lg"},we={class:"w-full text-sm text-left text-gray-500"},ke=n("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[n("tr",null,[n("th",{scope:"col",class:"px-6 py-3"}," Name "),n("th",{scope:"col",class:"px-6 py-3"}," Phone "),n("th",{scope:"col",class:"px-6 py-3"}," College "),n("th",{scope:"col",class:"px-6 py-3"}," Batch "),n("th",null," Details "),n("th",null," Actions ")])],-1),Ce={scope:"row",class:"px-6 py-4 font-medium whitespace-nowrap"},Ve={class:"px-6 py-4"},Pe={class:"px-6 py-4"},ze={class:"px-6 py-4"},$e={class:"mt-5"},Oe={key:1},Me={__name:"reviews",setup(e){const{$axios:g}=se(),_=Q(),s=N(null),a=N(_.query.page?parseInt(_.query.page):1),p=N(""),i=N(_.query.batch?_.query.batch:""),o=N(_.query.per_page?parseInt(_.query.per_page):50),m=async()=>{try{const u={};p.value&&(u.search=p.value),o.value&&(u.limit=o.value),a.value&&(u.page=a.value),i.value&&i.value!=="All Batch"&&(u.batch=i.value);const{data:r}=await g.get("/reviews",{params:u});s.value=r}catch(u){console.log(u.message)}},z=ee();te([i,o,a],()=>{m(),z.push({query:{batch:i.value,per_page:o.value,page:a.value}}),window.scrollTo(0,0)}),oe(p,()=>{m()},1e3),ne(()=>{m()});const D=async u=>{try{if(!confirm("Are you sure you want to delete this review?"))return;await g.delete(`/reviews/${u}`),m()}catch(r){console.log(r.message)}},G=async()=>{try{const u=s.value.data.map(h=>({name:h.name,phone:h.phone,college:h.college.name,batch:h.batch,...h})),r=Object.keys(u[0]),l=u.map(h=>r.map($=>JSON.stringify(h[$])).join(","));l.unshift(r.join(","));const c=l.join(`\r
`),V=new Blob([c],{type:"text/csv"}),v=window.URL.createObjectURL(V),w=document.createElement("a");w.href=v,w.download="submissions.csv",w.click()}catch(u){console.log(u.message)}};return(u,r)=>{const l=X,c=W,V=I,v=ie,w=pe,h=T,$=he,R=ae("Loader");return f(),B(q,null,[d(de),b(s)?(f(),B("div",be,[n("h1",ye," Reviews - Total "+L(b(s).total)+" Reviews ",1),n("div",ge,[d(c,{label:"Search"},{default:P(()=>[d(l,{modelValue:b(p),"onUpdate:modelValue":r[0]||(r[0]=t=>F(p)?p.value=t:null),placeholder:"Search"},null,8,["modelValue"])]),_:1}),n("div",_e,[n("div",null,[d(V,{onClick:G},{default:P(()=>[le(" Export to CSV ")]),_:1})]),d(c,{label:"Per Page"},{default:P(()=>[d(v,{options:[10,50,100,500,b(s).total],modelValue:b(o),"onUpdate:modelValue":r[1]||(r[1]=t=>F(o)?o.value=t:null),placeholder:"Per page"},null,8,["options","modelValue"])]),_:1}),d(c,{label:"Batch"},{default:P(()=>[d(v,{options:["All Batch","2025","2024","2023","2022","2021","2020"],modelValue:b(i),"onUpdate:modelValue":r[2]||(r[2]=t=>F(i)?i.value=t:null),placeholder:"HSC Batch"},null,8,["modelValue"])]),_:1})])]),b(s)&&b(s).data?(f(),B("div",Be,[n("table",we,[ke,n("tbody",null,[(f(!0),B(q,null,J(b(s).data,(t,y)=>(f(),B("tr",{key:t._id,class:"border-b"},[n("th",Ce,L(t.name),1),n("td",Ve,L(t.phone),1),n("td",Pe,L(t.college.name),1),n("td",ze,L(t.hsc_batch),1),n("td",null,[d(w,{review:t},null,8,["review"])]),n("td",null,[d(V,{onClick:k=>D(t._id),color:"red"},{default:P(()=>[d(h,{name:"lucide:trash"})]),_:2},1032,["onClick"])])]))),128))])])])):M("",!0),n("div",$e,[d($,{class:"mx-auto",modelValue:b(a),"onUpdate:modelValue":r[3]||(r[3]=t=>F(a)?a.value=t:null),"page-count":b(s).limit,total:b(s).total},null,8,["modelValue","page-count","total"])])])):(f(),B("div",Oe,[d(R)]))],64)}}};export{Me as default};
